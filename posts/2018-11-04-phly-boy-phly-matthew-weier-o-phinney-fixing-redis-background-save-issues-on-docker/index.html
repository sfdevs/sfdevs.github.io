<!DOCTYPE html>
<html lang="en"><meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<title>SFDevs  | Fixing Redis background-save issues on Docker</title>
<meta name="description" content="I&rsquo;ve been running redis in Docker for a number of sites, to perform things such as storing session data, hubot settings, and more.
I recently ran into a problem on one of my systems where it was reporting:
Can&#39;t save in background: fork: Out of memory  A quick google search showed this is a common error, so much so that there is an official FAQ about it. The solution is to toggle the /proc/sys/vm/overcommit_memory to 1.">
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
<link rel="icon" href="favicon.ico" type="image/x-icon">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="generator" content="Hugo 0.55.4" />
<script defer src="https://use.fontawesome.com/releases/v5.8.1/js/solid.js" integrity="sha384-IA6YnujJIO+z1m4NKyAGvZ9Wmxrd4Px8WFqhFcgRmwLaJaiwijYgApVpo1MV8p77" crossorigin="anonymous"></script>
<script defer src="https://use.fontawesome.com/releases/v5.8.1/js/brands.js" integrity="sha384-rUOIFHM3HXni/WG5pzDhA1e2Js5nn4bWudTYujHbbI9ztBIxK54CL4ZNZWwcBQeD" crossorigin="anonymous"></script>
<script defer src="https://use.fontawesome.com/releases/v5.8.1/js/fontawesome.js" integrity="sha384-EMmnH+Njn8umuoSMZ3Ae3bC9hDknHKOWL2e9WJD/cN6XLeAN7tr5ZQ0Hx5HDHtkS" crossorigin="anonymous"></script>




<link rel="stylesheet" href="/styles/main.b8186dec878e18853a059792b7bd6cc35a21a0505c9c9dfdd756851c89f3ef30.css" integrity="sha256-uBht7IeOGIU6BZeSt71sw1ohoFBcnJ3911aFHInz7zA=">

<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#6cc091">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#6cc091"><meta property="og:title" content="Fixing Redis background-save issues on Docker" />
<meta property="og:description" content="I&rsquo;ve been running redis in Docker for a number of sites, to perform things such as storing session data, hubot settings, and more.
I recently ran into a problem on one of my systems where it was reporting:
Can&#39;t save in background: fork: Out of memory  A quick google search showed this is a common error, so much so that there is an official FAQ about it. The solution is to toggle the /proc/sys/vm/overcommit_memory to 1." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://sfdevs.com/posts/2018-11-04-phly-boy-phly-matthew-weier-o-phinney-fixing-redis-background-save-issues-on-docker/" />
<meta property="article:published_time" content="2018-11-04T13:52:00&#43;00:00"/>
<meta property="article:modified_time" content="2018-11-04T13:52:00&#43;00:00"/>

  <meta property="fb:app_id" content="1171673062996168" />

<meta itemprop="name" content="Fixing Redis background-save issues on Docker">
<meta itemprop="description" content="I&rsquo;ve been running redis in Docker for a number of sites, to perform things such as storing session data, hubot settings, and more.
I recently ran into a problem on one of my systems where it was reporting:
Can&#39;t save in background: fork: Out of memory  A quick google search showed this is a common error, so much so that there is an official FAQ about it. The solution is to toggle the /proc/sys/vm/overcommit_memory to 1.">


<meta itemprop="datePublished" content="2018-11-04T13:52:00&#43;00:00" />
<meta itemprop="dateModified" content="2018-11-04T13:52:00&#43;00:00" />
<meta itemprop="wordCount" content="160">



<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Fixing Redis background-save issues on Docker"/>
<meta name="twitter:description" content="I&rsquo;ve been running redis in Docker for a number of sites, to perform things such as storing session data, hubot settings, and more.
I recently ran into a problem on one of my systems where it was reporting:
Can&#39;t save in background: fork: Out of memory  A quick google search showed this is a common error, so much so that there is an official FAQ about it. The solution is to toggle the /proc/sys/vm/overcommit_memory to 1."/>
<meta name="twitter:site" content="@_sfdevs"/>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-89597259-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

<script>
    window.fbAsyncInit = function() {
      FB.init({
        appId      : '1171673062996168',
        cookie     : true,
        xfbml      : true,
        version    : 'v3.2'
      });
      FB.AppEvents.logPageView();
    };

    (function(d, s, id){
       var js, fjs = d.getElementsByTagName(s)[0];
       if (d.getElementById(id)) {return;}
       js = d.createElement(s); js.id = id;
       js.src = "https://connect.facebook.net/en_US/sdk.js";
       fjs.parentNode.insertBefore(js, fjs);
     }(document, 'script', 'facebook-jssdk'));
  </script>

<body class="subpage"><header id="header">
    <div class="inner">
        <a href="https://sfdevs.com/" class="logo">SFDevs</a>
        <nav id="nav" role="menu">
        
        
            <a class="" href="/about/">
                <span>About</span>
            </a>
        
            <a class="" href="/posts/">
                <span>Community Posts</span>
            </a>
        
            <a class="" href="/jobs/">
                <span>Jobs</span>
            </a>
        
        </nav>
        <a href="#navPanel" class="navPanelToggle"><span class="fa fa-bars"></span></a>
    </div>
</header>

<section class="wrapper">
    <div class="inner">
    <header class="align-center">
        <h1>Fixing Redis background-save issues on Docker</h1>
    </header>

    <p>I&rsquo;ve been running redis in Docker for a number of sites, to perform things such
as storing session data, hubot settings, and more.</p>

<p>I recently ran into a problem on one of my systems where it was reporting:</p>

<pre><code>Can't save in background: fork: Out of memory

</code></pre>

<p>A quick google search showed this is a common error, so much so that there is an
<a href="https://redis.io/topics/faq#background-saving-fails-with-a-fork-error-under-linux-even-if-i-have-a-lot-of-free-ram">official FAQ about it</a>.
The solution is to toggle the <code>/proc/sys/vm/overcommit_memory</code> to 1.</p>

<p>The trick when using Docker is that this needs to happen on the <strong>host machine</strong>.</p>

<blockquote>
<p>This still didn't solve my problem, though. So I ran a `docker ps` on the host
machine to get an idea of what was happening. And discovered that, somehow, I
had two identical redis containers running, using the exact same configuration -
which meant they were doing backups to the same volume. Killing the one no
longer being used by my swarm services caused everything to work once again.</p>
</blockquote>

    </div>
</section>
<footer id="footer">
    <div class="inner">
        <h3>Get in touch</h3>

        <iframe src="https://services.cognitoforms.com/f/kLQF89okA06rKO0JYMWNOg?id=1" style="position:relative;width:1px;min-width:100%;*width:100%;" frameborder="0" scrolling="yes" seamless="seamless" height="465" width="100%"></iframe>
        <script src="https://services.cognitoforms.com/scripts/embed.js"></script>

        <div class="copyright">
            &copy; 2019 Sioux Falls Developer's Group.
        </div>
    </div>
</footer>
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha256-3edrmyuQ0w65f8gfBsqowzjJe2iM6n0nKciPUp8y+7E="
        crossorigin="anonymous"></script>
<script src="/js/skel.min.js"></script>
<script src="/js/main.min.js"></script>
</body>
</html>
