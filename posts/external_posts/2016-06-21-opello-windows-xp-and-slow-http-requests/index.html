<!doctype html><html class=no-js lang=en><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><title>SFDevs | Windows XP and Slow HTTP Requests</title><meta name=description content="This week at work I was faced with a bug that manifested as Windows XP clients being slower to access parts of a web interface than Windows 7 or 10. This was strange because in Wireshark the requests looked basically the same.
It turned out that the embedded system hosting the web interface was rejecting Ethernet frames larger than 1500 bytes. This was most likely because of a misinterpretation of the MTU as referring to the frame size (at layer 2) instead of the payload size (at layer 3)."><link rel="shortcut icon" href=favicon.ico type=image/x-icon><link rel=icon href=favicon.ico type=image/x-icon><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.71.1"><link rel=dns-prefetch href=https://use.fontawesome.com/><link rel=dns-prefetch href=https://fonts.gstatic.com><link rel=preload href=https://fonts.gstatic.com/s/sourcesanspro/v12/6xK3dSBYKcSV-LCoeQqfX1RYOo3qOK7lujVj9w.woff2 as=font type=font/woff2 crossorigin><script defer src=https://use.fontawesome.com/releases/v5.8.1/js/solid.js integrity=sha384-IA6YnujJIO+z1m4NKyAGvZ9Wmxrd4Px8WFqhFcgRmwLaJaiwijYgApVpo1MV8p77 crossorigin=anonymous></script><script defer src=https://use.fontawesome.com/releases/v5.8.1/js/brands.js integrity=sha384-rUOIFHM3HXni/WG5pzDhA1e2Js5nn4bWudTYujHbbI9ztBIxK54CL4ZNZWwcBQeD crossorigin=anonymous></script><script defer src=https://use.fontawesome.com/releases/v5.8.1/js/fontawesome.js integrity=sha384-EMmnH+Njn8umuoSMZ3Ae3bC9hDknHKOWL2e9WJD/cN6XLeAN7tr5ZQ0Hx5HDHtkS crossorigin=anonymous></script><link rel=stylesheet href=/styles/main.1e280c87bd9e983acb3a608852a39ec784fd3238fedff2bbe4f34aee0bf73a4b.css integrity="sha256-HigMh72emDrLOmCIUqOex4T9Mjj+3/K75PNK7gv3Oks="><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#6cc091><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#6cc091"><link rel=canonical href="http://opello.org/blog/2016/06/21/windows-xp-and-slow-http-requests?utm_source=sfdevs.com"><meta property="og:title" content="Windows XP and Slow HTTP Requests"><meta property="og:description" content="This week at work I was faced with a bug that manifested as Windows XP clients being slower to access parts of a web interface than Windows 7 or 10. This was strange because in Wireshark the requests looked basically the same.
It turned out that the embedded system hosting the web interface was rejecting Ethernet frames larger than 1500 bytes. This was most likely because of a misinterpretation of the MTU as referring to the frame size (at layer 2) instead of the payload size (at layer 3)."><meta property="og:type" content="article"><meta property="og:url" content="https://sfdevs.com/posts/external_posts/2016-06-21-opello-windows-xp-and-slow-http-requests/"><meta property="article:published_time" content="2016-06-21T05:00:00+00:00"><meta property="article:modified_time" content="2016-06-21T05:00:00+00:00"><meta itemprop=name content="Windows XP and Slow HTTP Requests"><meta itemprop=description content="This week at work I was faced with a bug that manifested as Windows XP clients being slower to access parts of a web interface than Windows 7 or 10. This was strange because in Wireshark the requests looked basically the same.
It turned out that the embedded system hosting the web interface was rejecting Ethernet frames larger than 1500 bytes. This was most likely because of a misinterpretation of the MTU as referring to the frame size (at layer 2) instead of the payload size (at layer 3)."><meta itemprop=datePublished content="2016-06-21T05:00:00+00:00"><meta itemprop=dateModified content="2016-06-21T05:00:00+00:00"><meta itemprop=wordCount content="367"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Windows XP and Slow HTTP Requests"><meta name=twitter:description content="This week at work I was faced with a bug that manifested as Windows XP clients being slower to access parts of a web interface than Windows 7 or 10. This was strange because in Wireshark the requests looked basically the same.
It turned out that the embedded system hosting the web interface was rejecting Ethernet frames larger than 1500 bytes. This was most likely because of a misinterpretation of the MTU as referring to the frame size (at layer 2) instead of the payload size (at layer 3)."><meta name=twitter:site content="@_sfdevs"><body class=subpage><a href=#mainContent class="sr-only sr-only-focusable skip-to">Skip to main content</a><div class="navbar navbar-expand-lg sticky-top navbar-dark bg-primary"><div class=container><a href=https://sfdevs.com/ class=navbar-brand>SFDevs</a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarText aria-controls=navbarText aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarText><ul class="navbar-nav ml-auto"><li class=nav-item><a class=nav-link href=/about/>About</a></li><li class=nav-item><a class=nav-link href=/posts/>Community Posts</a></li><li class=nav-item><a class=nav-link href=/events/>Events</a></li><li class=nav-item><a class=nav-link href=/jobs/>Jobs</a></li></ul></div></div></div><main id=mainContent class="mb-5 mt-5 page-main"><div class=container><header class="text-center mb-5"><h1>Windows XP and Slow HTTP Requests</h1></header><article><p>This week at work I was faced with a bug that manifested as Windows XP clients
being slower to access parts of a web interface than Windows 7 or 10. This was
strange because in Wireshark the requests looked basically the same.</p><p>It turned out that the embedded system hosting the web interface was rejecting
Ethernet frames larger than 1500 bytes. This was most likely because of a
misinterpretation of the MTU as referring to the frame size (at layer 2) instead
of the payload size (at layer 3).</p><p>The strangest part about this issue was just how consistent the effect was
across all browsers tested given a version of Windows. Windows XP took nearly
22 seconds to complete a request that took just over 2 seconds in Windows 7.
The core of this behavior ended up being a side-effect of the TCP retransmission
timeout.</p><p>The default retransmission timeout for Windows XP is stored in the
<code>TCPInitialRTT</code> registry value for a given network adapter. The default
value when the registry value does not exist is
3000ms. This aligned with the
observation under XP that the first retransmission occurred after 3
seconds with subsequent retransmissions occurring at 6 and 12 seconds. The
first retransmission was sent unfragmented while the second and third
retransmissions were a fragmented version of the original frame, which was
ultimately accepted. The fragmented payloads were at most 576 bytes which
seemed like an interesting size but I did not investigate.</p><p>Windows 7 on the other hand appears to retry after 300 milliseconds, with
subsequent retries at 600ms and 1200ms. But the same basic behavior was
followed: the first retry was the full payload while the subsequent retries
were fragmented into at most 576 byte payloads. The key difference appearing
to be the retransmission timeout. This masked the underlying issue for Windows
7 clients.</p><p>While I did not search extensively I did not find an explanation for either the
doubling back-off of the retransmissions or the 576 byte payload size.</p><p>The rather quick fix was to change the Linux driver to accept frames up to the
actual size that could be handled. And introducing an error message if a frame
is rejected for length reasons.</p></article></div></main><footer id=footer class="site-footer bg-primary"><div class=container><div class=text-white><div class=text-center><h2 class="h3 font-weight-normal mb-3">Get in touch</h2></div><div class=cognito><script src=https://www.cognitoforms.com/s/kLQF89okA06rKO0JYMWNOg></script><script>document.addEventListener('DOMContentLoaded',function(){Cognito.load("forms",{id:"1"});});</script></div></div><div class="float-md-left text-white align-middle">&copy; 2020 Sioux Falls Developer's Group.</div><div class="card bg-transparent border-white text-white float-md-right"><div class=card-body><span class="follow__social__copy mr-2 d-inline-block align-text-bottom" style=line-height:2>Follow SFDevs</span>
<a href=https://www.facebook.com/sfdevs title="Follow us on Facebook" class="text-white mr-2" target=_blank rel=noopener><i class="fab fa-facebook fa-2x"></i></a><a href=https://twitter.com/_sfdevs title="Follow us on Twitter" class=text-white target=_blank rel=noopener><i class="fab fa-twitter fa-2x"></i></a></div></div></div></footer><script src=/js/modernizr.js></script><script src=https://code.jquery.com/jquery-3.4.1.slim.min.js integrity=sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n crossorigin=anonymous></script><script src=/js/bootstrap.bundle.min.js></script><script src=/js/main.min.js></script><script src=https://www.cognitoforms.com/s/kLQF89okA06rKO0JYMWNOg></script><script data-goatcounter=https://sfdevs.goatcounter.com/count async src=//gc.zgo.at/count.js></script></body></html>