<!doctype html><html class=no-js lang=en><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><title>SFDevs | How to Debug Entity Framework Migration Errors</title><meta name=description content="Prerequisite In this article, I assume you have a working knowledge of the Entity Framework ORM and its migrations feature. If you don’t, take a look through Entity Framework documentation and its migrations section before continuing.
Introduction If you’ve ever worked with the Entity Framework ORM for any length of time, then you’ve likely worked with its migrations feature. And more than likely, you’ve had to debug one (or many) of your migrations when trying to run an update-database through the package manager console."><link rel="shortcut icon" href=favicon.ico type=image/x-icon><link rel=icon href=favicon.ico type=image/x-icon><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.71.1"><link rel=dns-prefetch href=https://use.fontawesome.com/><link rel=dns-prefetch href=https://fonts.gstatic.com><script defer src=https://use.fontawesome.com/releases/v5.8.1/js/solid.js integrity=sha384-IA6YnujJIO+z1m4NKyAGvZ9Wmxrd4Px8WFqhFcgRmwLaJaiwijYgApVpo1MV8p77 crossorigin=anonymous></script><script defer src=https://use.fontawesome.com/releases/v5.8.1/js/brands.js integrity=sha384-rUOIFHM3HXni/WG5pzDhA1e2Js5nn4bWudTYujHbbI9ztBIxK54CL4ZNZWwcBQeD crossorigin=anonymous></script><script defer src=https://use.fontawesome.com/releases/v5.8.1/js/fontawesome.js integrity=sha384-EMmnH+Njn8umuoSMZ3Ae3bC9hDknHKOWL2e9WJD/cN6XLeAN7tr5ZQ0Hx5HDHtkS crossorigin=anonymous></script><link rel=stylesheet href=/styles/main.06d71ff2ec0b9b738bb1298552bee6f75952d8f8b7ed77bc4d935de7fb0aa868.css integrity="sha256-Btcf8uwLm3OLsSmFUr7m91lS2Pi37Xe8TZNd5/sKqGg="><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#6cc091><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#6cc091"><link rel=canonical href="https://justinsoderstrom.com/entity-framework-migration-errors?utm_source=sfdevs.com"><meta property="og:title" content="How to Debug Entity Framework Migration Errors"><meta property="og:description" content="Prerequisite In this article, I assume you have a working knowledge of the Entity Framework ORM and its migrations feature. If you don’t, take a look through Entity Framework documentation and its migrations section before continuing.
Introduction If you’ve ever worked with the Entity Framework ORM for any length of time, then you’ve likely worked with its migrations feature. And more than likely, you’ve had to debug one (or many) of your migrations when trying to run an update-database through the package manager console."><meta property="og:type" content="article"><meta property="og:url" content="https://sfdevs.com/posts/external_posts/2019-01-21-jasoderstrom-how-to-debug-entity-framework-migration-errors/"><meta property="article:published_time" content="2019-01-21T00:00:00+00:00"><meta property="article:modified_time" content="2019-01-21T00:00:00+00:00"><meta itemprop=name content="How to Debug Entity Framework Migration Errors"><meta itemprop=description content="Prerequisite In this article, I assume you have a working knowledge of the Entity Framework ORM and its migrations feature. If you don’t, take a look through Entity Framework documentation and its migrations section before continuing.
Introduction If you’ve ever worked with the Entity Framework ORM for any length of time, then you’ve likely worked with its migrations feature. And more than likely, you’ve had to debug one (or many) of your migrations when trying to run an update-database through the package manager console."><meta itemprop=datePublished content="2019-01-21T00:00:00+00:00"><meta itemprop=dateModified content="2019-01-21T00:00:00+00:00"><meta itemprop=wordCount content="519"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="How to Debug Entity Framework Migration Errors"><meta name=twitter:description content="Prerequisite In this article, I assume you have a working knowledge of the Entity Framework ORM and its migrations feature. If you don’t, take a look through Entity Framework documentation and its migrations section before continuing.
Introduction If you’ve ever worked with the Entity Framework ORM for any length of time, then you’ve likely worked with its migrations feature. And more than likely, you’ve had to debug one (or many) of your migrations when trying to run an update-database through the package manager console."><meta name=twitter:site content="@_sfdevs"><body class=subpage><a href=#mainContent class="sr-only sr-only-focusable skip-to">Skip to main content</a><div class="navbar navbar-expand-lg sticky-top navbar-dark bg-primary"><div class=container><a href=https://sfdevs.com/ class=navbar-brand>SFDevs</a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarText aria-controls=navbarText aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarText><ul class="navbar-nav ml-auto"><li class=nav-item><a class=nav-link href=/about/>About</a></li><li class=nav-item><a class=nav-link href=/posts/>Community Posts</a></li><li class=nav-item><a class=nav-link href=/events/>Events</a></li><li class=nav-item><a class=nav-link href=/jobs/>Jobs</a></li></ul></div></div></div><main id=mainContent class="mb-5 mt-5 page-main"><div class=container><header class="text-center mb-5"><h1>How to Debug Entity Framework Migration Errors</h1></header><article><h1 id=svg-aria-hiddentrue-height16-version11-viewbox0-0-16-16-width16path-fill-ruleevenodd-dm4-9h1v1h4c-15-0-3-169-3-35s255-3-4-3h4c145-0-3-169-3-35-0-141-91-272-2-325v859c58-45-1-127-1-209c10-522-898-4-8-4h4c-98-0-2-122-2-25s3-9-4-9zm9-3h-1v1h1c1-0-2-122-2-25s1398-12-13-12h9c-98-0-2-122-2-25-0-8342-164-1-209v625c-10953-2-184-2-325c6-1131-755-13-9-13h4c145-0-3-169-3-35s145-6-13-6zpathsvgprerequisiteprerequisite><a href=#prerequisite></a>Prerequisite</h1><p>In this article, I assume you have a working knowledge of the Entity Framework ORM and its migrations feature. If you don’t, take a look through <a href=https://docs.microsoft.com/en-us/ef/>Entity Framework documentation</a> and its <a href=https://docs.microsoft.com/en-us/ef/ef6/modeling/code-first/migrations/>migrations section</a> before continuing.</p><h2 id=svg-aria-hiddentrue-height16-version11-viewbox0-0-16-16-width16path-fill-ruleevenodd-dm4-9h1v1h4c-15-0-3-169-3-35s255-3-4-3h4c145-0-3-169-3-35-0-141-91-272-2-325v859c58-45-1-127-1-209c10-522-898-4-8-4h4c-98-0-2-122-2-25s3-9-4-9zm9-3h-1v1h1c1-0-2-122-2-25s1398-12-13-12h9c-98-0-2-122-2-25-0-8342-164-1-209v625c-10953-2-184-2-325c6-1131-755-13-9-13h4c145-0-3-169-3-35s145-6-13-6zpathsvgintroductionintroduction><a href=#introduction></a>Introduction</h2><p>If you’ve ever worked with the Entity Framework ORM for any length of time, then you’ve likely worked with its migrations feature. And more than likely, you’ve had to debug one (or many) of your migrations when trying to run an update-database through the package manager console. Unfortunately, the errors displayed in the Entity Framework can be extremely cryptic. For example, one error I ran into recently was this:</p><p><strong>Validation failed for one or more entities. See &lsquo;EntityValidationErrors&rsquo; property for more details.</strong></p><p>Unfortunately, there is no way to view the EntityValidationErrors property when you run your migrations through the Package Manager Console. So, the only information you’ve got is a stack trace and a cryptic error message. Thanks Entity Framework!</p><p>So how do we view the error details? Run the migrations through code! By running our migrations through code, we can use Visual Studio’s (or any other IDE’s) debugging tools to drill down deeper into our errors.</p><h2 id=svg-aria-hiddentrue-height16-version11-viewbox0-0-16-16-width16path-fill-ruleevenodd-dm4-9h1v1h4c-15-0-3-169-3-35s255-3-4-3h4c145-0-3-169-3-35-0-141-91-272-2-325v859c58-45-1-127-1-209c10-522-898-4-8-4h4c-98-0-2-122-2-25s3-9-4-9zm9-3h-1v1h1c1-0-2-122-2-25s1398-12-13-12h9c-98-0-2-122-2-25-0-8342-164-1-209v625c-10953-2-184-2-325c6-1131-755-13-9-13h4c145-0-3-169-3-35s145-6-13-6zpathsvghow-to-run-a-migration-through-code-in-entity-framework-6how-to-run-a-migration-through-code-in-entity-framework-6><a href=#how-to-run-a-migration-through-code-in-entity-framework-6></a>How to Run a Migration Through Code in Entity Framework 6</h2><p>If you’re using Entity Framework 6 in your project, then running a migration through code is very simple. All you need to do is instantiate the DbMigrator class and call its Update method. This has the same effect as running update-database in the package manager console.</p><pre><code>using System.Data.Entity.Migrations;
var configuration = new Configuration(); // Your configuration class
var migrator = new DbMigrator(configuration);
migrator.Update(); // Same effect as running update-database
</code></pre><p>One thing to note is that the Configuration class is the class that gets generated when you first run enable-migrations in your project. However, you could pass a different class to the DbMigrator constructor if the class is or inherits from the DbMigrationsConfiguration class.</p><p>I haven’t tested it, but this method should also work for Entity Framework 4 and 5.</p><h2 id=svg-aria-hiddentrue-height16-version11-viewbox0-0-16-16-width16path-fill-ruleevenodd-dm4-9h1v1h4c-15-0-3-169-3-35s255-3-4-3h4c145-0-3-169-3-35-0-141-91-272-2-325v859c58-45-1-127-1-209c10-522-898-4-8-4h4c-98-0-2-122-2-25s3-9-4-9zm9-3h-1v1h1c1-0-2-122-2-25s1398-12-13-12h9c-98-0-2-122-2-25-0-8342-164-1-209v625c-10953-2-184-2-325c6-1131-755-13-9-13h4c145-0-3-169-3-35s145-6-13-6zpathsvghow-to-run-a-migration-through-code-in-entity-framework-20how-to-run-a-migration-through-code-in-entity-framework-20><a href=#how-to-run-a-migration-through-code-in-entity-framework-20></a>How to Run a Migration Through Code in Entity Framework 2.0</h2><p>If you’re using Entity Framework Core 2.0 (or greater), then running a migration through code is even simpler than in Entity Framework 6. Simply get an instance of your DbContext and call the Migrate method on its Database property.</p><pre><code>using Microsoft.EntityFrameworkCore;
var context = new ApplicationDbContext(null); // Use your DbContext here
context.Database.Migrate(); // Same effect as running update-database
</code></pre><h2 id=svg-aria-hiddentrue-height16-version11-viewbox0-0-16-16-width16path-fill-ruleevenodd-dm4-9h1v1h4c-15-0-3-169-3-35s255-3-4-3h4c145-0-3-169-3-35-0-141-91-272-2-325v859c58-45-1-127-1-209c10-522-898-4-8-4h4c-98-0-2-122-2-25s3-9-4-9zm9-3h-1v1h1c1-0-2-122-2-25s1398-12-13-12h9c-98-0-2-122-2-25-0-8342-164-1-209v625c-10953-2-184-2-325c6-1131-755-13-9-13h4c145-0-3-169-3-35s145-6-13-6zpathsvgsummarysummary><a href=#summary></a>Summary</h2><p>Debugging Entity Framework migrations through the package manager console can be very painful since all it provides you is a stack trace and a (sometimes) cryptic error message. But by running your migrations programmatically, you can take advantage of your IDE’s debugging tools as you would any other error!</p><h2 id=svg-aria-hiddentrue-height16-version11-viewbox0-0-16-16-width16path-fill-ruleevenodd-dm4-9h1v1h4c-15-0-3-169-3-35s255-3-4-3h4c145-0-3-169-3-35-0-141-91-272-2-325v859c58-45-1-127-1-209c10-522-898-4-8-4h4c-98-0-2-122-2-25s3-9-4-9zm9-3h-1v1h1c1-0-2-122-2-25s1398-12-13-12h9c-98-0-2-122-2-25-0-8342-164-1-209v625c-10953-2-184-2-325c6-1131-755-13-9-13h4c145-0-3-169-3-35s145-6-13-6zpathsvgwarningwarning><a href=#warning></a>Warning</h2><p>This method of debugging has worked well for me in the past, but I want to stress that this is not perfect. You must modify your application’s codebase to get this to work, which could lead to unintended side effects. So, use this method sparingly!</p><p><strong>If you have a different (or better) idea on how to debug Entity Framework migrations, please leave a comment below!</strong></p></article></div></main><footer id=footer class="site-footer bg-primary"><div class=container><div class=text-white><div class=text-center><h2 class="h3 font-weight-normal mb-3">Get in touch</h2></div><div class=cognito><script src=https://www.cognitoforms.com/s/kLQF89okA06rKO0JYMWNOg></script><script>document.addEventListener('DOMContentLoaded',function(){Cognito.load("forms",{id:"1"});});</script></div></div><div class="float-md-left text-white align-middle">&copy; 2020 Sioux Falls Developer's Group.</div><div class="card bg-transparent border-white text-white float-md-right"><div class=card-body><span class="follow__social__copy mr-2 d-inline-block align-text-bottom" style=line-height:2>Follow SFDevs</span>
<a href=https://www.facebook.com/sfdevs title="Follow us on Facebook" class="text-white mr-2" target=_blank rel=noopener><i class="fab fa-facebook fa-2x"></i></a><a href=https://twitter.com/_sfdevs title="Follow us on Twitter" class=text-white target=_blank rel=noopener><i class="fab fa-twitter fa-2x"></i></a></div></div></div></footer><script src=/js/modernizr.js></script><script src=https://code.jquery.com/jquery-3.4.1.slim.min.js integrity=sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n crossorigin=anonymous></script><script src=/js/bootstrap.bundle.min.js></script><script src=/js/main.min.js></script><script src=https://www.cognitoforms.com/s/kLQF89okA06rKO0JYMWNOg></script><script data-goatcounter=https://sfdevs.goatcounter.com/count async src=//gc.zgo.at/count.js></script></body></html>