<!doctype html><html lang=en><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><title>SFDevs | NameSilo API from PowerShell</title><meta name=description content="A friend asked several people on irc about NameSilo&rsquo;s API and dynamic DNS entries. He found a PowerShell script to update a subdomain with the current IP address of the system running the script. The subdomain detail was the crux of the question: how to get it to update a &ldquo;naked&rdquo; domain. Several of us read through the API reference but the dnsUpdateRecord function didn&rsquo;t explain how to update the base domain&rsquo;s A record."><link rel="shortcut icon" href=favicon.ico type=image/x-icon><link rel=icon href=favicon.ico type=image/x-icon><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.55.6"><script defer src=https://use.fontawesome.com/releases/v5.8.1/js/solid.js integrity=sha384-IA6YnujJIO+z1m4NKyAGvZ9Wmxrd4Px8WFqhFcgRmwLaJaiwijYgApVpo1MV8p77 crossorigin=anonymous></script><script defer src=https://use.fontawesome.com/releases/v5.8.1/js/brands.js integrity=sha384-rUOIFHM3HXni/WG5pzDhA1e2Js5nn4bWudTYujHbbI9ztBIxK54CL4ZNZWwcBQeD crossorigin=anonymous></script><script defer src=https://use.fontawesome.com/releases/v5.8.1/js/fontawesome.js integrity=sha384-EMmnH+Njn8umuoSMZ3Ae3bC9hDknHKOWL2e9WJD/cN6XLeAN7tr5ZQ0Hx5HDHtkS crossorigin=anonymous></script><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Montserrat:500,900|Knewave"><link rel=stylesheet href=/styles/main.c1af6829ba8f007e9a41864163894b2474ad2b5f7b38b6def082239dd6da9cf3.css integrity="sha256-wa9oKbqPAH6aQYZBY4lLJHStK197OLbe8IIjndbanPM="><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#6cc091><meta name=msapplication-TileColor content=#da532c><meta name=theme-color content=#6cc091><link rel=canonical href=http://opello.org/blog/2016/02/14/namesilo-api-from-powershell><meta property=og:title content="NameSilo API from PowerShell"><meta property=og:description content="A friend asked several people on irc about NameSilo&rsquo;s API and dynamic DNS entries. He found a PowerShell script to update a subdomain with the current IP address of the system running the script. The subdomain detail was the crux of the question: how to get it to update a &ldquo;naked&rdquo; domain. Several of us read through the API reference but the dnsUpdateRecord function didn&rsquo;t explain how to update the base domain&rsquo;s A record."><meta property=og:type content=article><meta property=og:url content=https://sfdevs.com/posts/external_posts/2016-02-14-opello-namesilo-api-from-powershell/><meta property=article:published_time content=2016-02-14T06:00:00&#43;00:00><meta property=article:modified_time content=2016-02-14T06:00:00&#43;00:00><meta property=fb:app_id content=1171673062996168><meta itemprop=name content="NameSilo API from PowerShell"><meta itemprop=description content="A friend asked several people on irc about NameSilo&rsquo;s API and dynamic DNS entries. He found a PowerShell script to update a subdomain with the current IP address of the system running the script. The subdomain detail was the crux of the question: how to get it to update a &ldquo;naked&rdquo; domain. Several of us read through the API reference but the dnsUpdateRecord function didn&rsquo;t explain how to update the base domain&rsquo;s A record."><meta itemprop=datePublished content=2016-02-14T06:00:00&#43;00:00><meta itemprop=dateModified content=2016-02-14T06:00:00&#43;00:00><meta itemprop=wordCount content=380><meta itemprop=keywords content><meta name=twitter:card content=summary><meta name=twitter:title content="NameSilo API from PowerShell"><meta name=twitter:description content="A friend asked several people on irc about NameSilo&rsquo;s API and dynamic DNS entries. He found a PowerShell script to update a subdomain with the current IP address of the system running the script. The subdomain detail was the crux of the question: how to get it to update a &ldquo;naked&rdquo; domain. Several of us read through the API reference but the dnsUpdateRecord function didn&rsquo;t explain how to update the base domain&rsquo;s A record."><meta name=twitter:site content=@_sfdevs><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-89597259-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script>window.fbAsyncInit=function(){FB.init({appId:'1171673062996168',cookie:true,xfbml:true,version:'v3.2'});FB.AppEvents.logPageView();};(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(d.getElementById(id)){return;}
js=d.createElement(s);js.id=id;js.src="https://connect.facebook.net/en_US/sdk.js";fjs.parentNode.insertBefore(js,fjs);}(document,'script','facebook-jssdk'));</script><body class=subpage><header id=header><div class=inner><a href=https://sfdevs.com/ class=logo>SFDevs</a><nav id=nav role=menu><a href=/about/><span>About</span></a>
<a href=/posts/><span>Community Posts</span></a>
<a href=/jobs/><span>Jobs</span></a></nav><a href=#navPanel class=navPanelToggle><span class="fa fa-bars"></span></a></div></header><section class=wrapper><div class=inner><header class=align-center><h1>NameSilo API from PowerShell</h1></header><p>A friend asked several people on irc about NameSilo&rsquo;s API and dynamic DNS
entries. He found
<a href=http://www.forkrobotics.com/2014/10/dynamic-dns-with-namesilo-and-powershell/>a PowerShell script</a>
to update a subdomain with the current IP address of the system running the
script. The subdomain detail was the crux of the question: how to get it to
update a &ldquo;naked&rdquo; domain. Several of us read through
<a href=https://www.namesilo.com/api_reference.php>the API reference</a> but the
<a href=https://www.namesilo.com/api_reference.php#dnsUpdateRecord>dnsUpdateRecord</a>
function didn&rsquo;t explain how to update the base domain&rsquo;s A record.</p><p>It turned out that simply leaving off the <code>rrhost</code> parameter was sufficient to
get the job done.</p><p>After we were done iterating on it, we had a PowerShell function to update any
record. Including enough intelligence to handle the base domain case. I don&rsquo;t
believe non-A records were tested, but it met the need of updating the base
domain and a sub-domain or two from a scheduled task.</p><pre><code># NameSilo API Dynamic DNS
# Variables
$APIkey = &amp;quot;&amp;quot;
$domain = &amp;quot;&amp;quot;

function NameSilo-dnsUpdateRecord {
    param ([string]$APIKey, [string]$Domain, [string]$Record, [string]$Type)

    # Retrieve the DNS entries in the domain.
    $listdomains = Invoke-RestMethod -Uri &amp;quot;https://www.namesilo.com/api/dnsListRecords?version=1&amp;amp;type=xml&amp;amp;key=$APIkey&amp;amp;domain=$domain&amp;quot;
    $Records = $listdomains.namesilo.reply.resource_record | where { $_.type -eq $Type }

    $UpdateRecord = $null
    $IsNaked = $False
    foreach ($r in $Records ) {
        if ([string]::IsNullOrEmpty($Record) -and $r.host -eq $Domain) {
            $UpdateRecord = $r
            $IsNaked = $True
            break
        } elseif ($r.host -eq &amp;quot;$($Record).$($Domain)&amp;quot;) {
            $UpdateRecord = $r
            break
        }
    }
    if ($UpdateRecord -eq $null) {
        echo &amp;quot;Error: Could not find requested record: $($Record).$($Domain)&amp;quot;
        Exit
    }

    $CurrentIP = $listdomains.namesilo.request.ip
    $RecordIP = $UpdateRecord.value
    $RecordID = $UpdateRecord.record_id

    # Only update the record if necessary.
    if ($CurrentIP -ne $RecordIP){
        $url = &amp;quot;https://www.namesilo.com/api/dnsUpdateRecord?version=1&amp;amp;type=xml&amp;amp;key=$APIkey&amp;amp;domain=$Domain&amp;amp;rrid=$RecordID&amp;quot;
        if ($IsNaked -eq $False) {
            $url += &amp;quot;&amp;amp;rrhost=$record&amp;quot;
        }
        $url += &amp;quot;&amp;amp;rrvalue=$CurrentIP&amp;amp;rrttl=3600&amp;quot;
        $update = Invoke-RestMethod -Uri $url
    } else {
        echo &amp;quot;IP Address has not changed.&amp;quot;
    }
}

# Invocations:
NameSilo-dnsUpdateRecord -APIKey $APIkey -Domain $domain -Record &amp;quot;&amp;quot; -Type &amp;quot;A&amp;quot;
NameSilo-dnsUpdateRecord -APIKey $APIkey -Domain $domain -Record &amp;quot;*&amp;quot; -Type &amp;quot;A&amp;quot;
NameSilo-dnsUpdateRecord -APIKey $APIkey -Domain $domain -Record &amp;quot;test&amp;quot; -Type &amp;quot;A&amp;quot;

</code></pre><p>Since I don&rsquo;t do hardly anything in PowerShell, aside from trying to use it more
than <code>cmd.exe</code> on Windows because it is a resizable window, I did a little
more reading after this was written and concluded that it is not likely
representative of PowerShell best practices.</p><p>But it is posted here just in case it might be useful to someone.</p></div></section><footer id=footer><div class=inner><h3>Get in touch</h3><iframe src="https://services.cognitoforms.com/f/kLQF89okA06rKO0JYMWNOg?id=1" style=position:relative;width:1px;min-width:100%;*width:100% frameborder=0 scrolling=yes seamless height=465 width=100%></iframe>
<script src=https://services.cognitoforms.com/scripts/embed.js></script><div class="row footer__copy-social"><div class="copyright 6u 12u$(small)">&copy; 2019 Sioux Falls Developer's Group.</div><div class="6u 12u$(small) social"><div class=footer__social><span class=follow__social__copy>Follow SFDevs</span>
<a href=https://www.facebook.com/sfdevs title="Follow us on Facebook" class=like-us target=_blank rel=noopener><i class="fab fa-facebook fa-2x"></i></a><a href=https://twitter.com/_sfdevs title="Follow us on Twitter" class=like-us target=_blank rel=noopener><i class="fab fa-twitter fa-2x"></i></a></div></div></div></div></footer><script src=https://code.jquery.com/jquery-3.3.1.slim.min.js integrity="sha256-3edrmyuQ0w65f8gfBsqowzjJe2iM6n0nKciPUp8y+7E=" crossorigin=anonymous></script><script src=/js/skel.min.js></script><script src=/js/main.min.js></script></body></html>